@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  * {
    @apply border-border;
  }

  html, body {
    @apply font-sans antialiased bg-background text-foreground;
    touch-action: pan-x pan-y;
  }

  /* Modern gradient background */
  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background:
      radial-gradient(circle at 20% 20%, hsl(250 100% 60% / 0.08) 0%, transparent 50%),
      radial-gradient(circle at 80% 80%, hsl(280 100% 60% / 0.08) 0%, transparent 50%);
    pointer-events: none;
    z-index: 0;
  }

  body > * {
    position: relative;
    z-index: 1;
  }

  /* Improve mobile touch targets */
  @media (max-width: 768px) {
    button, a, input[type="button"], input[type="submit"] {
      min-height: 44px;
      min-width: 44px;
    }

    /* Better mobile spacing */
    .p-4 {
      @apply p-3;
    }

    /* Improve mobile readability */
    body {
      font-size: 16px; /* Prevents zoom on iOS */
    }

    /* Better text sizing on mobile */
    h1 {
      @apply text-2xl;
    }

    h2 {
      @apply text-xl;
    }

    h3 {
      @apply text-lg;
    }

    /* Ensure code blocks are scrollable on mobile */
    pre {
      max-width: 100%;
      overflow-x: auto;
    }

    /* Better modal/sheet widths on mobile */
    [role="dialog"] {
      max-width: 100vw !important;
    }
  }
}

/* Force word breaking for chat messages to prevent overflow */
@layer utilities {
  .chat-message-content {
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    word-break: break-word !important;
    max-width: 100% !important;
    width: 100% !important;
    min-width: 0 !important;
    /* Prevent flickering during streaming */
    contain: layout style paint;
    will-change: auto;
  }

  .chat-message-content *:not(strong):not(em):not(code):not(a) {
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    word-break: break-word !important;
    max-width: 100% !important;
    min-width: 0 !important;
  }

  /* Apply more gentle word breaking to inline elements */
  .chat-message-content strong,
  .chat-message-content em,
  .chat-message-content code,
  .chat-message-content a {
    overflow-wrap: break-word !important;
    word-wrap: break-word !important;
    /* Remove the aggressive word-break: break-word for inline elements */
    max-width: 100% !important;
  }

  .chat-message-content pre,
  .chat-message-content code {
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    word-break: break-word !important;
    max-width: 100% !important;
    overflow-x: auto !important;
  }

  .chat-message-content table {
    width: 100% !important;
    max-width: 100% !important;
    table-layout: fixed !important;
    overflow-x: auto !important;
  }

  .chat-message-content td,
  .chat-message-content th {
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    word-break: break-word !important;
    max-width: 0 !important;
  }

  /* Prevent flickering on message cards during streaming */
  .animate-fade-in {
    animation: none !important;
  }

  /* Stabilize prose rendering to prevent layout shifts */
  .prose {
    contain: layout;
  }

  /* Ensure paragraphs don't cause layout shifts */
  .prose p {
    margin-top: 0;
    margin-bottom: 1rem;
  }

  .prose p:last-child {
    margin-bottom: 0;
  }
}